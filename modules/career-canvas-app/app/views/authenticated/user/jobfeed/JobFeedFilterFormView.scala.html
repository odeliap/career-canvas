@import careercanvas.io.model.jobfeed._
@(
sortByForm: Form[model.forms.SortByForm],
jobInfos: Seq[JobInfo]
)(content: Html)(script: Html)(implicit request: MessagesRequestHeader)

@authenticated.user.AuthenticatedUserLayout("Feed | Career Canvas") {
    <div class="main-page">
        <div>
            @request.flash.data.map{ case (name, value) =>
            @if(name.equals("error")) {
            <div class="error-flash">@value</div>
            } else if (name.equals("success")) {
            <div class="success-flash">@value</div>
            } else {
            <div class="info-flash">@value</div>
            }
            }
        </div>
        @content
        @helper.select(
        sortByForm("sortKey"),
        options = SortKey.values.map(sortKey => sortKey.toString -> s"Sort By ${sortKey.toString.replaceAll("\\d+", "").replaceAll("(.)([A-Z])", "$1 $2")}"),
        '_label -> "",
        '_default -> "Sort By Date Created",
        'id -> "sort-by-form"
        )
        <div class="job-tiles">
            @jobInfos.map { jobInfo =>
            <div class="job-tile">
                <div class="job-tile-header">
                    <a href="@routes.JobFeedController.showJobView(jobInfo)" class="job-company">@jobInfo.company</a>
                    <p class="job-title">@jobInfo.jobTitle</p>
                </div>
                <div class="metadata-fields">
                    <div class="metadata">
                        <img src="@routes.Assets.versioned("images/jobfeed/" + jobInfo.status + ".png")" alt="@{jobInfo.status}" class="metadata-icon">
                        <p class="meta-title">Status:</p>
                        <p class="meta-content">@jobInfo.status.toString.replaceAll("\\d+", "").replaceAll("(.)([A-Z])", "$1 $2")</p>
                    </div>
                    <div class="metadata">
                        <img src="@routes.Assets.versioned("images/jobfeed/calendar.png")" class="metadata-icon">
                        <p class="meta-title">Last Update:</p>
                        <p class="meta-content">@jobInfo.lastUpdate.toLocalDateTime.toLocalDate.toString</p>
                    </div>
                </div>
            </div>
            }
        </div>
        @FooterTemplate()
        <script>
            @script
        </script>
    </div>
}