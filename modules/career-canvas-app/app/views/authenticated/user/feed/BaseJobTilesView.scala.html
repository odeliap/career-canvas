@import careercanvas.io.model.job._
@import java.sql.Timestamp
@(
jobInfos: Seq[JobInfo]
)(content: Html)(script: Html)(implicit request: MessagesRequestHeader)

@authenticated.user.AuthenticatedUserLayout("Feed | Career Canvas") {
<div class="main-page">
    <div>
        @request.flash.data.map{ case (name, value) =>
        @if(name.equals("error")) {
        <div class="error-flash">@value</div>
        } else if (name.equals("success")) {
        <div class="success-flash">@value</div>
        } else {
        <div class="info-flash">@value</div>
        }
        }
    </div>

    @content

    <div id="job-search-container">
        <div>
            <label class="filter-param" for="lastUpdate">Last Update:</label>
            <select class="filter-param" id="lastUpdate">
                <option value="876600">All time</option>
                <option value="168">Last 7 days</option>
                <option value="72">Last 3 days</option>
                <option value="24">Last 24 hours</option>
            </select>

            <label class="filter-param" for="company">Company:</label>
            <select class="filter-param" id="company">
                <option value="">All Companies</option>
                @for(company <- jobInfos.map(_.company).distinct) {
                <option value="@company">@company</option>
                }
            </select>

            <input type="checkbox" id="showStarred">
            <label for="showStarred" id="showStarredLabel"></label>
        </div>
    </div>

    <div id="job-tiles">
        @jobInfos.map { jobInfo =>
        <div class="job-tile" data-company="@jobInfo.company" data-lastupdate="@jobInfo.lastUpdate.getTime" data-starred="@jobInfo.starred.toString.toLowerCase()">
            <div class="job-tile-header">
                <div class="job-tile-subheader">
                    <div class="job-company">@jobInfo.company</div>
                    <a href="@routes.JobFeedController.starJob(jobInfo.jobId)">
                        @if(jobInfo.starred) {
                        <img src="@routes.Assets.versioned("images/feed/tile/bookmark.png")" class="star-icon starred">
                        } else {
                        <img src="@routes.Assets.versioned("images/feed/tile/bookmark.png")" class="star-icon">
                        }
                    </a>
                </div>
                <p class="job-title">@jobInfo.jobTitle</p>
            </div>
            <div class="metadata-fields">
                <div class="metadata">
                    <div class="metadata-tag" style="background-color: @utils.ColorUtils.jobStatusToColor(jobInfo.status);"></div>
                    <img src="@routes.Assets.versioned("images/feed/tile/status/" + jobInfo.status + ".png")" alt="@{jobInfo.status}" class="metadata-icon">
                    <p class="meta-title">Status:</p>
                    <p class="meta-content">@jobInfo.status.toString.replaceAll("\\d+", "").replaceAll("(.)([A-Z])", "$1 $2")</p>
                </div>
                <div class="metadata">
                    <div class="metadata-tag" style="background-color: @utils.ColorUtils.localDateTimeToColor(jobInfo.lastUpdate.toLocalDateTime);"></div>
                    <img src="@routes.Assets.versioned("images/feed/tile/calendar.png")" class="metadata-icon">
                    <p class="meta-title">Last Update:</p>
                    <p class="meta-content">@jobInfo.lastUpdate.toLocalDateTime.toLocalDate.toString</p>
                </div>
            </div>
            <a href="@routes.IndividualJobController.showJobView(jobInfo)" class="view-job-button">View Job</a>
        </div>
        }
    </div>

    <div class="pagination">
        <button id="prevPage">Previous</button>
        <div id="pageNumbersContainer"></div>
        <button id="nextPage">Next</button>
    </div>

    @FooterTemplate()
    <script src="@routes.Assets.versioned("javascripts/jobFilters.js")" type="text/javascript"></script>
</div>
}
