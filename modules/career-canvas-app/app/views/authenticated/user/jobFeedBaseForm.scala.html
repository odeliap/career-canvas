@import careercanvas.io.model._
@(
sortByForm: Form[SortByForm],
jobInfos: Seq[JobInfo]
)(content: Html)(script: Html)(implicit request: MessagesRequestHeader)

@main("Job Feed") {
    <div>
        @request.flash.data.map{ case (name, value) =>
            @if(name.equals("error")) {
                <div class="error-flash">@value</div>
            } else if (name.equals("success")) {
                <div class="success-flash">@value</div>
            } else {
                <div class="info-flash">@value</div>
            }
        }
</div>
    @content
    @helper.select(
        sortByForm("sortKey"),
        options = SortKey.values.map(sortKey => sortKey.toString -> s"Sort By ${sortKey.toString.replaceAll("\\d+", "").replaceAll("(.)([A-Z])", "$1 $2")}"),
        '_label -> "",
        '_default -> "Sort By Date Created",
        'id -> "sort-by-form"
    )
    <div class="job-tiles">
        @jobInfos.map { jobInfo =>
            <div class="job-tile">
                <div class="job-tile-tab">@jobInfo.jobTitle</div>
                <p>Company: @jobInfo.company</p>
                <p>Status: @jobInfo.status.toString.replaceAll("\\d+", "").replaceAll("(.)([A-Z])", "$1 $2")</p>
                @if(jobInfo.interviewRound.nonEmpty) {
                    @if(!jobInfo.interviewRound.get.equals(0)) {
                        <p>Interview Round: @jobInfo.interviewRound</p>
                    }
                }
                @if(jobInfo.appSubmissionDate.nonEmpty) {
                    <p>App Submission Date: @jobInfo.status</p>
                }
                <p>Last Update: @jobInfo.lastUpdate</p>
            </div>
        }
    </div>

    <script>
        @script
    </script>
}